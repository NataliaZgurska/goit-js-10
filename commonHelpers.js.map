{"version":3,"file":"commonHelpers.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from \"flatpickr\";\nimport \"flatpickr/dist/flatpickr.min.css\";\nimport iziToast from \"izitoast\";\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst inputForm = document.querySelector('#datetime-picker');\nconst btn = document.querySelector('button');\n\nconst daysSet = document.querySelector('span[data-days]');\nconst hoursSet = document.querySelector('span[data-hours]');\nconst minutesSet = document.querySelector('span[data-minutes]');\nconst secondsSet = document.querySelector('span[data-seconds]');\n\nlet userSelectedDate;\nlet difference;\nlet timerIntervalId;\n\nbtn.disabled = true;\nbtn.style.backgroundColor = '#989898';\ninputForm.disabled = false;\ninputForm.style.color = '#000000;'; \ninputForm.style.borderColor = 'blue';\n\nconst options = {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n  onClose(selectedDates) {\n      userSelectedDate = selectedDates[0];\n      \n    if (userSelectedDate > new Date()) {\n        // якщо обрана дата правильна, то кнопка стає активною\n        btn.disabled = false;\n        btn.style.backgroundColor = '#4e75ff';\n    } else {\n      // якщо обрана дата неправильна, то кнопка стає неактивною + повідомлення\n        btn.disabled = true;\n        btn.style.backgroundColor = '#989898';\n              \n        iziToast.show({\n            close: true,\n            message: 'Оберіть дату в майбутньому',\n            messageColor: '#FFFFFF',\n            backgroundColor: '#B51B1B',\n            position: 'topCenter',\n            close: true,\n            timeout: 5000\n        });\n    }\n},\n};\n \nflatpickr('#datetime-picker', options);\n\nbtn.addEventListener('click', onBtnStartClick);\n\nfunction onBtnStartClick(e) {\n  // зупиняєм таймер еscape-ом\n  document.addEventListener('keydown', onKeyClick); \n  \n  // робимо кнопку і інпут неактивними\n  btn.disabled = true;\n  inputForm.disabled = true;\n  btn.style.backgroundColor = '#989898';\n  inputForm.style.color = '#808080'; \n  inputForm.style.borderColor = '#808080';\n  \n  // запускаємо інтервал в 1000мс: виводимо difference на екран \n  timerIntervalId = setInterval(() => {\n    difference = userSelectedDate - new Date();\n      \n    if (difference>1000) {\n       // конвертуємо ms в дні-години-хвилини-секунди і форматуємо в двозначний вигляд \n        const difObj = convertMs(difference);\n        const difArray = Object.values(difObj).map((elem) => String(elem).padStart(2, 0));\n        // виводимо дні-години-хвилини-секунди на екран\n        daysSet.textContent = difArray[0];\n        hoursSet.textContent = difArray[1];\n        minutesSet.textContent = difArray[2];\n        secondsSet.textContent = difArray[3];\n    } else {\n      timerIntervalStop();\n    }\n\n }, 1000);\n  \n}\n\nfunction convertMs(ms) {\n  // Number of milliseconds per unit of time\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n   const days = Math.floor(ms / day);\n   const hours = Math.floor((ms % day) / hour);\n   const minutes = Math.floor(((ms % day) % hour) / minute);\n   const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n  return { days, hours, minutes, seconds };\n}\n\nfunction timerIntervalStop(e) {\n  clearInterval(timerIntervalId);\n  secondsSet.textContent = '00';\n\n  // робимо активним інтпут\n  inputForm.disabled = false;\n  inputForm.style.color = '#000000;'; \n  inputForm.style.borderColor = 'blue';\n\n  // перевірка на закінчення таймера\n  if (difference <= 1000) greeting();\nelse console.log('таймер зупинено');\n}\n\nfunction onKeyClick(e) {\n  if (e.code === 'Escape') {\n    timerIntervalStop();\n    //    document.removeEventListener('keydown', onKeyClick); \n\n  } \n}\n\nfunction greeting() {\n    iziToast.show({\n      close: true,\n      message: 'Цей час настав!',\n      messageColor: '#060695',\n      backgroundColor: '#ffff00',\n      position: 'topCenter',\n      close: true,\n      timeout: 10000\n    });\n}"],"names":["inputForm","btn","daysSet","hoursSet","minutesSet","secondsSet","userSelectedDate","difference","timerIntervalId","options","selectedDates","iziToast","flatpickr","onBtnStartClick","onKeyClick","difObj","convertMs","difArray","elem","timerIntervalStop","ms","days","hours","minutes","seconds","greeting"],"mappings":"+IAKA,MAAMA,EAAY,SAAS,cAAc,kBAAkB,EACrDC,EAAM,SAAS,cAAc,QAAQ,EAErCC,EAAU,SAAS,cAAc,iBAAiB,EAClDC,EAAW,SAAS,cAAc,kBAAkB,EACpDC,EAAa,SAAS,cAAc,oBAAoB,EACxDC,EAAa,SAAS,cAAc,oBAAoB,EAE9D,IAAIC,EACAC,EACAC,EAEJP,EAAI,SAAW,GACfA,EAAI,MAAM,gBAAkB,UAC5BD,EAAU,SAAW,GACrBA,EAAU,MAAM,MAAQ,WACxBA,EAAU,MAAM,YAAc,OAE9B,MAAMS,EAAU,CACd,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,QAAQC,EAAe,CACnBJ,EAAmBI,EAAc,GAE/BJ,EAAmB,IAAI,MAEvBL,EAAI,SAAW,GACfA,EAAI,MAAM,gBAAkB,YAG5BA,EAAI,SAAW,GACfA,EAAI,MAAM,gBAAkB,UAE5BU,EAAS,KAAK,CACV,MAAO,GACP,QAAS,6BACT,aAAc,UACd,gBAAiB,UACjB,SAAU,YACV,MAAO,GACP,QAAS,GACrB,CAAS,EAET,CACA,EAEAC,EAAU,mBAAoBH,CAAO,EAErCR,EAAI,iBAAiB,QAASY,CAAe,EAE7C,SAASA,EAAgB,EAAG,CAE1B,SAAS,iBAAiB,UAAWC,CAAU,EAG/Cb,EAAI,SAAW,GACfD,EAAU,SAAW,GACrBC,EAAI,MAAM,gBAAkB,UAC5BD,EAAU,MAAM,MAAQ,UACxBA,EAAU,MAAM,YAAc,UAG9BQ,EAAkB,YAAY,IAAM,CAGlC,GAFAD,EAAaD,EAAmB,IAAI,KAEhCC,EAAW,IAAM,CAEjB,MAAMQ,EAASC,EAAUT,CAAU,EAC7BU,EAAW,OAAO,OAAOF,CAAM,EAAE,IAAKG,GAAS,OAAOA,CAAI,EAAE,SAAS,EAAG,CAAC,CAAC,EAEhFhB,EAAQ,YAAce,EAAS,GAC/Bd,EAAS,YAAcc,EAAS,GAChCb,EAAW,YAAca,EAAS,GAClCZ,EAAW,YAAcY,EAAS,EAC1C,MACME,GAGJ,EAAE,GAAI,CAER,CAEA,SAASH,EAAUI,EAAI,CAOpB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAC1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EACpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EACjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAEnE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACxC,CAEA,SAASL,EAAkB,EAAG,CAC5B,cAAcX,CAAe,EAC7BH,EAAW,YAAc,KAGzBL,EAAU,SAAW,GACrBA,EAAU,MAAM,MAAQ,WACxBA,EAAU,MAAM,YAAc,OAG1BO,GAAc,IAAMkB,IACrB,QAAQ,IAAI,iBAAiB,CAClC,CAEA,SAASX,EAAW,EAAG,CACjB,EAAE,OAAS,UACbK,GAIJ,CAEA,SAASM,GAAW,CAChBd,EAAS,KAAK,CACZ,MAAO,GACP,QAAS,kBACT,aAAc,UACd,gBAAiB,UACjB,SAAU,YACV,MAAO,GACP,QAAS,GACf,CAAK,CACL"}